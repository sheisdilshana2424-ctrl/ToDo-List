<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="theme-color" content="#000000">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="description" content="Level Up: Elite Productivity">
<title>Level Up: Elite</title>

<!-- Fonts & Icons -->
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
    :root {
        --bg-dark: #050505;
        --glass-bg: rgba(20, 20, 22, 0.6);
        --glass-border: rgba(255, 255, 255, 0.08);
        --primary: #8b5cf6;
        --primary-glow: rgba(139, 92, 246, 0.5);
        --accent: #06b6d4;
        --success: #10b981;
        --text-main: #ffffff;
        --text-muted: #94a3b8;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }

    body {
        font-family: 'Outfit', sans-serif;
        background-color: var(--bg-dark);
        color: var(--text-main);
        min-height: 100vh;
        overflow-x: hidden;
        /* Subtle Premium Background */
        background-image: 
            radial-gradient(circle at 0% 0%, rgba(139, 92, 246, 0.1) 0%, transparent 50%),
            radial-gradient(circle at 100% 50%, rgba(6, 182, 212, 0.05) 0%, transparent 50%);
        padding-bottom: 80px; /* Space for scrolling */
    }

    /* --- 1. PREMIUM SPLASH SCREEN --- */
    #splash-screen {
        position: fixed; inset: 0;
        background: #000;
        display: flex; flex-direction: column; justify-content: center; align-items: center;
        z-index: 9999;
        transition: opacity 0.8s ease, visibility 0.8s;
    }

    .splash-logo-box {
        width: 80px; height: 80px;
        background: linear-gradient(135deg, var(--primary), var(--accent));
        border-radius: 20px;
        display: grid; place-items: center;
        font-size: 32px; color: white;
        box-shadow: 0 0 60px var(--primary-glow);
        margin-bottom: 20px;
        animation: float 3s ease-in-out infinite;
    }

    .splash-text {
        font-size: 1.5rem; font-weight: 700; letter-spacing: 2px;
        background: linear-gradient(to right, #fff, #a5b4fc);
        -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        text-transform: uppercase;
    }

    /* --- 2. MAIN CONTAINER --- */
    .app-container {
        max-width: 500px; margin: 0 auto;
        padding: 20px;
        opacity: 0; transform: translateY(20px);
        transition: opacity 0.6s ease, transform 0.6s ease;
    }

    /* --- 3. HERO VIDEO (3:4 RATIO) --- */
    .hero-wrapper {
        width: 100%;
        aspect-ratio: 3/4; /* Creates the vertical box */
        border-radius: 24px;
        overflow: hidden;
        position: relative;
        margin-bottom: 24px;
        box-shadow: 0 10px 40px -10px rgba(0,0,0,0.8);
        border: 1px solid var(--glass-border);
    }

    .hero-video {
        width: 100%; height: 100%;
        object-fit: cover; /* CROPS VIDEO TO CENTER WITHOUT STRETCHING */
        transform: scale(1.05); /* Slight zoom to remove edges */
    }

    .hero-overlay {
        position: absolute; inset: 0;
        background: linear-gradient(to bottom, rgba(0,0,0,0) 60%, rgba(5,5,5,0.9) 100%);
        pointer-events: none;
    }

    /* --- 4. HEADER & STATS --- */
    .header-info {
        display: flex; justify-content: space-between; align-items: center;
        margin-bottom: 20px;
    }

    .date-pill {
        font-size: 0.85rem; color: var(--text-muted);
        background: var(--glass-bg); padding: 8px 16px; border-radius: 30px;
        border: 1px solid var(--glass-border);
        backdrop-filter: blur(10px);
    }

    .streak-display {
        display: flex; align-items: center; gap: 8px;
        font-size: 1.2rem; font-weight: 800; color: #fbbf24;
        text-shadow: 0 0 15px rgba(251, 191, 36, 0.3);
    }

    /* --- 5. CONTROLS & PROGRESS --- */
    .mode-switch {
        display: flex; gap: 8px; margin-bottom: 20px;
    }
    
    .mode-btn {
        flex: 1; padding: 14px; border: none; background: #121212;
        color: var(--text-muted); font-weight: 600; border-radius: 14px;
        border: 1px solid var(--glass-border);
        transition: 0.3s;
    }

    .mode-btn.active {
        background: linear-gradient(135deg, #27272a, #18181b);
        color: #fff; border-color: rgba(255,255,255,0.2);
        box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }

    .progress-bar-container {
        height: 6px; background: #27272a; border-radius: 10px;
        margin-bottom: 25px; overflow: hidden; position: relative;
    }
    
    .progress-fill {
        height: 100%; width: 0%;
        background: linear-gradient(90deg, var(--accent), var(--primary));
        border-radius: 10px;
        box-shadow: 0 0 15px var(--primary-glow);
        transition: width 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    /* --- 6. TASK LIST --- */
    .task-list { list-style: none; padding-bottom: 15px; }

    .task-item {
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid rgba(255, 255, 255, 0.04);
        padding: 18px 20px; border-radius: 16px;
        margin-bottom: 10px;
        display: flex; align-items: center;
        transition: all 0.3s ease;
        opacity: 0; transform: translateY(10px);
    }

    .task-item:active { transform: scale(0.97); background: rgba(255,255,255,0.06); }
    
    .task-item.completed {
        background: rgba(16, 185, 129, 0.08);
        border-color: rgba(16, 185, 129, 0.2);
    }
    
    .task-item.completed span { 
        text-decoration: line-through; color: var(--text-muted); opacity: 0.7; 
    }

    .check-circle {
        width: 24px; height: 24px;
        border: 2px solid #52525b; border-radius: 50%;
        margin-right: 16px; flex-shrink: 0;
        display: flex; align-items: center; justify-content: center;
        transition: 0.3s;
    }

    .task-item.completed .check-circle {
        background: var(--success); border-color: var(--success); color: white;
        box-shadow: 0 0 12px rgba(16, 185, 129, 0.4);
    }

    /* --- 7. FOOTER ACTION --- */
    textarea {
        width: 100%; height: 80px;
        background: #121212; border: 1px solid #27272a;
        color: white; padding: 15px; border-radius: 14px;
        resize: none; font-family: inherit; margin-bottom: 15px;
        font-size: 0.9rem;
    }
    textarea:focus { outline: 1px solid var(--primary); }

    .complete-btn {
        width: 100%; padding: 16px;
        background: linear-gradient(135deg, var(--primary), #7c3aed);
        color: white; border: none; border-radius: 16px;
        font-size: 1rem; font-weight: 700; letter-spacing: 1px;
        box-shadow: 0 8px 25px -5px var(--primary-glow);
    }
    
    .complete-btn:active { transform: scale(0.98); }

    /* Animations */
    @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }
    @keyframes fadeInUp { from { opacity: 0; transform: translateY(15px); } to { opacity: 1; transform: translateY(0); } }
    
    .animate-entry { animation: fadeInUp 0.5s ease forwards; }
</style>
</head>
<body>

<!-- AUDIO (Autoplays on first touch) -->
<!-- Ensure public/bg1.mp3 exists -->
<audio id="appAudio" loop>
    <source src="public/bg1.mp3" type="audio/mpeg">
</audio>

<!-- SPLASH SCREEN -->
<div id="splash-screen">
    <div class="splash-logo-box">
        <i class="fas fa-rocket"></i>
    </div>
    <div class="splash-text">LEVEL UP</div>
</div>

<div class="app-container" id="mainApp">
    
    <!-- VIDEO HERO -->
    <div class="hero-wrapper">
        <!-- object-fit: cover ensures the video fills the 3:4 box perfectly -->
        <video class="hero-video" autoplay muted loop playsinline poster="">
            <source src="public/vid1.webm" type="video/webm">
        </video>
        <div class="hero-overlay"></div>
    </div>

    <!-- STATS -->
    <div class="header-info">
        <div class="date-pill" id="dateDisplay">Loading...</div>
        <div class="streak-display">
            <i class="fas fa-fire"></i> <span id="streakVal">0</span>
        </div>
    </div>

    <!-- MODE SWITCHER -->
    <div class="mode-switch">
        <button class="mode-btn active" id="btnFocus" onclick="setMode('focus')">ðŸ”¥ Focus</button>
        <button class="mode-btn" id="btnCollege" onclick="setMode('college')">ðŸŽ“ College</button>
    </div>

    <!-- PROGRESS -->
    <div class="progress-bar-container">
        <div class="progress-fill" id="xpBar"></div>
    </div>

    <!-- TASKS -->
    <ul class="task-list" id="taskList">
        <!-- JS Injects Tasks Here -->
    </ul>

    <!-- INPUT -->
    <textarea id="dailyLog" placeholder="ðŸ“ Log your learning..."></textarea>
    
    <button class="complete-btn" onclick="completeDay()">
        COMPLETE DAY
    </button>
</div>

<!-- CANVAS CONFETTI -->
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<script>
    // --- CONFIGURATION ---
    const TASKS = {
        focus: [
            "ðŸ—£ English Speaking (40m)",
            "ðŸ’» Web Dev / Coding (2h)",
            "ðŸ‹ï¸ Workout (1h)",
            "ðŸ“š Reading & Revision"
        ],
        college: [
            "ðŸ—£ English Practice (15m)",
            "ðŸ’» Quick Coding (30m)",
            "ðŸ‹ï¸ Workout (45m)",
            "ðŸ“ Class Notes Review"
        ]
    };

    // --- STATE MANAGEMENT ---
    let appState = {
        mode: localStorage.getItem('mode') || 'focus',
        streak: parseInt(localStorage.getItem('streak')) || 0,
        checks: JSON.parse(localStorage.getItem('checks')) || [],
        lastDate: localStorage.getItem('lastDate')
    };

    const audio = document.getElementById('appAudio');
    const today = new Date().toDateString();

    // --- INITIALIZATION ---
    window.onload = () => {
        // 1. Date & Reset Check
        document.getElementById('dateDisplay').innerText = today;
        if (appState.lastDate !== today) {
            appState.checks = []; // Reset checkboxes for new day
            localStorage.setItem('checks', JSON.stringify([]));
            localStorage.setItem('lastDate', today);
        }

        // 2. Render Initial UI
        setMode(appState.mode, false);
        document.getElementById('streakVal').innerText = appState.streak;

        // 3. Remove Splash Screen & Animate In
        setTimeout(() => {
            const splash = document.getElementById('splash-screen');
            const main = document.getElementById('mainApp');
            
            splash.style.opacity = '0';
            splash.style.visibility = 'hidden';
            
            main.style.opacity = '1';
            main.style.transform = 'translateY(0)';
            
            // Staggered Animation for List
            animateList();
        }, 2200); // 2.2s Splash duration
    };

    // --- AUDIO AUTO-PLAY FIX ---
    // Android WebViews block autoplay. We unlock it on the first touch anywhere.
    function unlockAudio() {
        if (audio.paused) {
            audio.volume = 0.6; // 60% volume
            audio.play().catch(e => console.log("Waiting for interaction..."));
            // Remove listeners once played
            document.body.removeEventListener('click', unlockAudio);
            document.body.removeEventListener('touchstart', unlockAudio);
        }
    }
    document.body.addEventListener('click', unlockAudio);
    document.body.addEventListener('touchstart', unlockAudio);

    // --- CORE FUNCTIONS ---
    function setMode(mode, reset = true) {
        appState.mode = mode;
        localStorage.setItem('mode', mode);

        // Update Buttons
        document.getElementById('btnFocus').className = mode === 'focus' ? 'mode-btn active' : 'mode-btn';
        document.getElementById('btnCollege').className = mode === 'college' ? 'mode-btn active' : 'mode-btn';

        // Reset Checks if changing mode manually
        const taskCount = TASKS[mode].length;
        if (reset || appState.checks.length !== taskCount) {
            appState.checks = new Array(taskCount).fill(false);
        }

        renderList();
        updateProgress();
    }

    function renderList() {
        const list = document.getElementById('taskList');
        list.innerHTML = '';

        TASKS[appState.mode].forEach((text, i) => {
            const isDone = appState.checks[i];
            const li = document.createElement('li');
            
            li.className = `task-item ${isDone ? 'completed' : ''}`;
            li.style.animationDelay = `${i * 0.1}s`; // Stagger effect
            li.classList.add('animate-entry');
            li.onclick = () => toggleCheck(i);

            li.innerHTML = `
                <div class="check-circle">
                    ${isDone ? '<i class="fas fa-check"></i>' : ''}
                </div>
                <span>${text}</span>
            `;
            list.appendChild(li);
        });
    }

    function toggleCheck(index) {
        appState.checks[index] = !appState.checks[index];
        localStorage.setItem('checks', JSON.stringify(appState.checks));
        
        // Re-render specifically this logic would be more efficient, 
        // but re-rendering full list is safer for keeping state synced visually
        renderList();
        updateProgress();
        
        // Vibrate on Android
        if(navigator.vibrate) navigator.vibrate(40);
    }

    function updateProgress() {
        const total = appState.checks.length;
        const done = appState.checks.filter(Boolean).length;
        const percent = (done / total) * 100;
        document.getElementById('xpBar').style.width = `${percent}%`;
        return percent;
    }

    function animateList() {
        const items = document.querySelectorAll('.task-item');
        items.forEach((item) => {
            // Trigger reflow to restart animation
            item.style.animation = 'none';
            item.offsetHeight; 
            item.style.animation = null; 
        });
    }

    function completeDay() {
        const percent = updateProgress();
        if (percent < 100) {
            alert("âš ï¸ Finish all tasks to complete the day!");
            return;
        }

        // Increment Streak
        appState.streak++;
        localStorage.setItem('streak', appState.streak);
        document.getElementById('streakVal').innerText = appState.streak;

        // Celebrate
        confetti({
            particleCount: 150,
            spread: 70,
            origin: { y: 0.6 }
        });

        alert("ðŸ”¥ Day Complete! Streak Updated.");
    }
</script>
</body>
</html>
